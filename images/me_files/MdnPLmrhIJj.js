if (self.CavalryLogger) { CavalryLogger.start_js(["6ZXtR"]); }

__d("ChatUnreadCount",["ChatDispatcher","ChatUnreadCountActionTypes","MercuryIDs","MercurySingletonProvider","MercuryThreadInformer","MessengerState.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};function a(a){this.$1=a,this.$2=b("MercuryThreadInformer").getForFBID(a),this.$3=new Map(),this.setupSubscriptions()}var c=a.prototype;c.getUnreadCountForUID=function(a){if(!a)return null;var c=b("MercuryIDs").getThreadIDFromUserID(a),d=b("MessengerState.bs").getThreadMetaNow(this.$1,c);d||b("MessengerState.bs").getThreadMeta(this.$1,c,function(a){});c=d&&d.unread_count;this.$3.set(a,c);return c};c.setupSubscriptions=function(){__p&&__p();var a=this;this.$2.subscribe("threads-updated",function(c,d){c=Object.keys(d).some(function(c){c=b("MercuryIDs").getUserIDFromThreadID(c);if(!c)return!1;var d=a.getUnreadCountForUID(c);c=a.$3.get(c)||0;return d!==c});c&&b("ChatDispatcher").dispatch({type:b("ChatUnreadCountActionTypes").COUNT_UPDATED})});this.$2.subscribe("unread-updated",function(){return b("ChatDispatcher").dispatch({type:b("ChatUnreadCountActionTypes").COUNT_UPDATED})})};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("legacy:popup-resizer",["PopupWindow"],(function(a,b,c,d,e,f){a.PopupResizer=b("PopupWindow")}),3);